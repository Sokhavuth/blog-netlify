import { c as create_ssr_component, a as subscribe, v as validate_component, b as add_attribute, e as escape, d as each } from "../../../../../../chunks/ssr.js";
import { L as Layout } from "../../../../../../chunks/Layout2.js";
import { a as activePage, I as Items } from "../../../../../../chunks/Items.js";
import "jquery";
const css = {
  code: ".Editor.svelte-205qft.svelte-205qft{background-color:white;height:100%}.Editor.svelte-205qft .wrapper.svelte-205qft{height:300px}.Editor.svelte-205qft input.svelte-205qft,.Editor.svelte-205qft select.svelte-205qft,.Editor.svelte-205qft .form input.svelte-205qft,.Editor.svelte-205qft .form select.svelte-205qft{width:100%;font:var(--body-font);padding:3px 5px}.Editor.svelte-205qft .frame.svelte-205qft,.Editor.svelte-205qft .form.svelte-205qft,.Editor.svelte-205qft .viddata div.svelte-205qft{display:grid;grid-template-columns:20% 32.5% 32.5% 15%;;}.Editor.svelte-205qft .viddata div.svelte-205qft{width:100%}.Editor.svelte-205qft .viddata div p.svelte-205qft:hover{cursor:pointer;color:red}.Editor.svelte-205qft .viddata b.svelte-205qft,.Editor.svelte-205qft .viddata input.svelte-205qft,.Editor.svelte-205qft .viddata p.svelte-205qft{font:var(--body-font);padding:5px;background:lightgrey;border:1px solid grey;text-align:center;color:black}.Editor.svelte-205qft .viddata input.svelte-205qft{background:white}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\r\\n    import Layout from \\"$lib/components/admin/Layout.svelte\\"\\r\\n    import Items from \\"$lib/components/admin/Items.svelte\\"\\r\\n    import { browser } from '$app/environment'\\r\\n    import jq from 'jquery'\\r\\n    import {activePage} from \\"$lib/stores/page.js\\"\\r\\n    export let data\\r\\n    let category\\r\\n    $: categories = data.post.categories\\r\\n    $: json = data.post.videos\\r\\n    let type, id, status\\r\\n    let videos = []\\r\\n    $:  if(data.post?.videos){\\r\\n            videos = JSON.parse(data.post.videos)\\r\\n        }else{\\r\\n            videos = []\\r\\n        }\\r\\n    \\r\\n    function getCategory(){\\r\\n        if(categories === ''){\\r\\n            categories += category\\r\\n        }else{\\r\\n            categories += (\`, \${category}\`)\\r\\n        }\\r\\n    }\\r\\n\\r\\n    function submitForm(){\\r\\n        if(videos.length){\\r\\n            let newVideos = []\\r\\n            let part = {}\\r\\n            let key = {0:'type', 1:'id', 2:'status'}\\r\\n\\r\\n            for(let v=1; v<=videos.length; v++){\\r\\n                for(let j=0; j<3; j++){\\r\\n                    part[key[j]] = jq(\`.viddata div:eq(\${v}) input:eq(\${j})\`).val()\\r\\n                }\\r\\n\\r\\n                newVideos.push({...part})\\r\\n            }\\r\\n\\r\\n            json = JSON.stringify(newVideos)\\r\\n        }\\r\\n    }\\r\\n\\r\\n    const genJson = () => {        \\r\\n        let video = {type, id, status}\\r\\n        let success = false\\r\\n    \\r\\n        for(let v in video){\\r\\n            if(!video[v]){\\r\\n                alert('ចូរ​បំពេញ​កន្លែង​អត្តសញ្ញាណ​វីដេអូ')\\r\\n                success = false\\r\\n                break\\r\\n            }else{\\r\\n                success = true\\r\\n            }\\r\\n        }\\r\\n\\r\\n        if(success){\\r\\n            videos = [video, ...videos]\\r\\n            json = JSON.stringify(videos)\\r\\n        }  \\r\\n    }\\r\\n\\r\\n    function deleteRow(e) {\\r\\n        let index = parseInt(e.target.innerHTML)\\r\\n        videos.splice(videos.length - index, 1)\\r\\n        videos = [...videos]\\r\\n        json = JSON.stringify(videos)\\r\\n    }\\r\\n\\r\\n<\/script>\\r\\n\\r\\n<Layout {data}>\\r\\n    <div class=\\"Editor\\" slot=\\"editor\\">\\r\\n        <form action={\`?/update&p=\${$activePage}\`} method=\\"post\\" on:submit={submitForm}>\\r\\n            <input type=\\"hidden\\" name=\\"id\\" value={data.post.id} />\\r\\n            <input type=\\"hidden\\" name=\\"author\\" value={data.post.author} />\\r\\n            <input type=\\"text\\" name=\\"title\\" value={data.post.title} requred placeholder=\\"ចំណងជើង\\" />\\r\\n            <div class=\\"wrapper\\">\\r\\n                <textarea name=\\"content\\" id=\\"editor\\">{data.post.content}</textarea>\\r\\n            </div>\\r\\n            <input type=\\"text\\" value={categories} on:input={e => categories = e.target.value} name=\\"categories\\" required placeholder=\\"ជំពូក\\" />\\r\\n            <div class=\\"frame\\">\\r\\n                <select name=\\"category\\" bind:value={category} on:change={getCategory} >\\r\\n                    <option disabled selected>ជ្រើសរើស​យក​ជំពូក</option>\\r\\n                    {#each data.categories as category}\\r\\n                    <option>{category.title}</option>\\r\\n                    {/each}\\r\\n                </select>\\r\\n                <input type=\\"text\\" name=\\"thumb\\" value={data.post.thumb} required placeholder=\\"រូប​​តំណាង\\" />\\r\\n                <input type=\\"datetime-local\\" value={data.post.date} step=\\"1\\" name=\\"datetime\\" required />\\r\\n                <input type=\\"submit\\" value=\\"ចុះ​ផ្សាយ\\" />\\r\\n                <input type=\\"hidden\\" name=\\"videos\\" bind:value={json} />\\r\\n            </div>\\r\\n            {#if browser}\\r\\n            <script src=\\"/scripts/ckeditor/config.js\\"><\/script>\\r\\n            {/if}\\r\\n        </form>\\r\\n        <div class='form'>\\r\\n            <select name='type' bind:value={type} >\\r\\n                <option>YouTube</option>\\r\\n                <option>YouTubePlaylist</option>\\r\\n                <option>Facebook</option>\\r\\n                <option>OK</option>\\r\\n                <option>Dailymotion</option>\\r\\n                <option>Vimeo</option>\\r\\n            </select>\\r\\n            <input name='videoid' bind:value={id} type='text' placeholder=\\"អត្តសញ្ញាណ​វីដេអូ\\" required />\\r\\n            <select name='status' bind:value={status} >\\r\\n                <option>ចប់</option>\\r\\n                <option>នៅ​មាន​ត</option>\\r\\n                <option>~ ចប់</option>\\r\\n            </select>\\r\\n            <input on:click={genJson} type=\\"button\\" value=\\"បញ្ចូលវីដេអូ\\" />\\r\\n        </div>\\r\\n\\r\\n        <div class='viddata'>\\r\\n            <div>\\r\\n                {#if videos.length}\\r\\n                <b>ប្រភេទ​វីដេអូ​</b><b>អត្តសញ្ញាណ​វីដេអូ​</b><b>ស្ថានភាព</b><b>ភាគ/លុប</b>\\r\\n                {/if}\\r\\n            </div>\\r\\n            {#each videos as video, i}\\r\\n            <div>\\r\\n                <input value={video.type} required />\\r\\n                <input value={video.id} required />\\r\\n                <input value={video.status} required />\\r\\n                <p title=\\"Delete\\" on:click={deleteRow} class=\\"episode\\">{videos.length-i}</p>\\r\\n            </div>\\r\\n            {/each}\\r\\n        </div>\\r\\n    </div>\\r\\n    <Items slot=\\"items\\" {data} />\\r\\n</Layout>\\r\\n\\r\\n<style>\\r\\n    .Editor{\\r\\n        background-color: white;\\r\\n        height: 100%;\\r\\n    } \\r\\n    .Editor .wrapper{\\r\\n        height: 300px;\\r\\n    }\\r\\n    .Editor input, .Editor select,\\r\\n    .Editor .form input, .Editor .form select{\\r\\n        width: 100%;\\r\\n        font: var(--body-font);\\r\\n        padding: 3px 5px;\\r\\n    }\\r\\n    .Editor .frame, .Editor .form, .Editor .viddata div{\\r\\n        display: grid;\\r\\n        grid-template-columns: 20% 32.5% 32.5% 15%;;\\r\\n    }\\r\\n    .Editor .viddata div{\\r\\n        width: 100%;\\r\\n    }\\r\\n    .Editor .viddata div p:hover{\\r\\n        cursor: pointer;\\r\\n        color: red;\\r\\n    }\\r\\n    .Editor .viddata b,\\r\\n    .Editor .viddata input,\\r\\n    .Editor .viddata p{\\r\\n        font: var(--body-font);\\r\\n        padding: 5px;\\r\\n        background: lightgrey;\\r\\n        border: 1px solid grey;\\r\\n        text-align: center;\\r\\n        color: black;\\r\\n    }\\r\\n    .Editor .viddata input{\\r\\n        background: white;\\r\\n    }\\r\\n</style>\\r\\n"],"names":[],"mappings":"AAyII,mCAAO,CACH,gBAAgB,CAAE,KAAK,CACvB,MAAM,CAAE,IACZ,CACA,qBAAO,CAAC,sBAAQ,CACZ,MAAM,CAAE,KACZ,CACA,qBAAO,CAAC,mBAAK,CAAE,qBAAO,CAAC,oBAAM,CAC7B,qBAAO,CAAC,KAAK,CAAC,mBAAK,CAAE,qBAAO,CAAC,KAAK,CAAC,oBAAM,CACrC,KAAK,CAAE,IAAI,CACX,IAAI,CAAE,IAAI,WAAW,CAAC,CACtB,OAAO,CAAE,GAAG,CAAC,GACjB,CACA,qBAAO,CAAC,oBAAM,CAAE,qBAAO,CAAC,mBAAK,CAAE,qBAAO,CAAC,QAAQ,CAAC,iBAAG,CAC/C,OAAO,CAAE,IAAI,CACb,qBAAqB,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAC/C,CACA,qBAAO,CAAC,QAAQ,CAAC,iBAAG,CAChB,KAAK,CAAE,IACX,CACA,qBAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAC,MAAM,CACxB,MAAM,CAAE,OAAO,CACf,KAAK,CAAE,GACX,CACA,qBAAO,CAAC,QAAQ,CAAC,eAAC,CAClB,qBAAO,CAAC,QAAQ,CAAC,mBAAK,CACtB,qBAAO,CAAC,QAAQ,CAAC,eAAC,CACd,IAAI,CAAE,IAAI,WAAW,CAAC,CACtB,OAAO,CAAE,GAAG,CACZ,UAAU,CAAE,SAAS,CACrB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CACtB,UAAU,CAAE,MAAM,CAClB,KAAK,CAAE,KACX,CACA,qBAAO,CAAC,QAAQ,CAAC,mBAAK,CAClB,UAAU,CAAE,KAChB"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let categories;
  let json;
  let $activePage, $$unsubscribe_activePage;
  $$unsubscribe_activePage = subscribe(activePage, (value) => $activePage = value);
  let { data } = $$props;
  let id;
  let videos = [];
  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);
  $$result.css.add(css);
  categories = data.post.categories;
  json = data.post.videos;
  {
    if (data.post?.videos) {
      videos = JSON.parse(data.post.videos);
    } else {
      videos = [];
    }
  }
  $$unsubscribe_activePage();
  return `${validate_component(Layout, "Layout").$$render($$result, { data }, {}, {
    items: () => {
      return `${validate_component(Items, "Items").$$render($$result, { slot: "items", data }, {}, {})}`;
    },
    editor: () => {
      return `<div class="Editor svelte-205qft" slot="editor"><form${add_attribute("action", `?/update&p=${$activePage}`, 0)} method="post"><input type="hidden" name="id"${add_attribute("value", data.post.id, 0)} class="svelte-205qft"> <input type="hidden" name="author"${add_attribute("value", data.post.author, 0)} class="svelte-205qft"> <input type="text" name="title"${add_attribute("value", data.post.title, 0)} requred placeholder="ចំណងជើង" class="svelte-205qft"> <div class="wrapper svelte-205qft"><textarea name="content" id="editor">${escape(data.post.content, false)}</textarea></div> <input type="text"${add_attribute("value", categories, 0)} name="categories" required placeholder="ជំពូក" class="svelte-205qft"> <div class="frame svelte-205qft"><select name="category" class="svelte-205qft"><option disabled selected value="ជ្រើសរើស​យក​ជំពូក" data-svelte-h="svelte-1sme7yw">ជ្រើសរើស​យក​ជំពូក</option>${each(data.categories, (category) => {
        return `<option${add_attribute("value", category.title, 0)}>${escape(category.title)}</option>`;
      })}</select> <input type="text" name="thumb"${add_attribute("value", data.post.thumb, 0)} required placeholder="រូប​​តំណាង" class="svelte-205qft"> <input type="datetime-local"${add_attribute("value", data.post.date, 0)} step="1" name="datetime" required class="svelte-205qft"> <input type="submit" value="ចុះ​ផ្សាយ" class="svelte-205qft"> <input type="hidden" name="videos" class="svelte-205qft"${add_attribute("value", json, 0)}></div> ${``}</form> <div class="form svelte-205qft"><select name="type" class="svelte-205qft"><option value="YouTube" data-svelte-h="svelte-vx8gkp">YouTube</option><option value="YouTubePlaylist" data-svelte-h="svelte-7i52wb">YouTubePlaylist</option><option value="Facebook" data-svelte-h="svelte-ftltlc">Facebook</option><option value="OK" data-svelte-h="svelte-j2dz52">OK</option><option value="Dailymotion" data-svelte-h="svelte-qmvqqv">Dailymotion</option><option value="Vimeo" data-svelte-h="svelte-qatw7i">Vimeo</option></select> <input name="videoid" type="text" placeholder="អត្តសញ្ញាណ​វីដេអូ" required class="svelte-205qft"${add_attribute("value", id, 0)}> <select name="status" class="svelte-205qft"><option value="ចប់" data-svelte-h="svelte-zmt308">ចប់</option><option value="នៅ​មាន​ត" data-svelte-h="svelte-sohzmq">នៅ​មាន​ត</option><option value="~ ចប់" data-svelte-h="svelte-1fwec4e">~ ចប់</option></select> <input type="button" value="បញ្ចូលវីដេអូ" class="svelte-205qft"></div> <div class="viddata svelte-205qft"><div class="svelte-205qft">${videos.length ? `<b class="svelte-205qft" data-svelte-h="svelte-105ivtg">ប្រភេទ​វីដេអូ​</b><b class="svelte-205qft" data-svelte-h="svelte-1n8adua">អត្តសញ្ញាណ​វីដេអូ​</b><b class="svelte-205qft" data-svelte-h="svelte-1gr9mi7">ស្ថានភាព</b><b class="svelte-205qft" data-svelte-h="svelte-13zgfqs">ភាគ/លុប</b>` : ``}</div> ${each(videos, (video, i) => {
        return `<div class="svelte-205qft"><input${add_attribute("value", video.type, 0)} required class="svelte-205qft"> <input${add_attribute("value", video.id, 0)} required class="svelte-205qft"> <input${add_attribute("value", video.status, 0)} required class="svelte-205qft"> <p title="Delete" class="episode svelte-205qft">${escape(videos.length - i)}</p> </div>`;
      })}</div></div>`;
    }
  })}`;
});
export {
  Page as default
};
